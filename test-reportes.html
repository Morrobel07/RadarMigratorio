<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test - Agregar Datos de Reportes</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 2rem;
        background: #f5f5f5;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      button {
        background: #002147;
        color: white;
        padding: 1rem 2rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1rem;
        margin: 0.5rem;
      }
      button:hover {
        background: #001533;
      }
      .log {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 4px;
        margin: 1rem 0;
        font-family: monospace;
        white-space: pre-wrap;
        max-height: 300px;
        overflow-y: auto;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>🧪 Test de Reportes - Radar Migratorio</h1>
      <p>
        Usa esta página para agregar datos de prueba y verificar el funcionamiento del sistema de
        reportes.
      </p>

      <div>
        <button onclick="agregarDatos()">📝 Agregar Datos de Prueba</button>
        <button onclick="verReportes()">📊 Ver Reportes Guardados</button>
        <button onclick="limpiarDatos()">🗑️ Limpiar Datos</button>
        <button onclick="irAlAdmin()">👨‍💼 Ir al Admin</button>
      </div>

      <div id="log" class="log">Listo para ejecutar pruebas...</div>
    </div>

    <script src="assets/js/dataManager.js"></script>
    <script>
      function log(mensaje) {
        const logDiv = document.getElementById('log')
        const timestamp = new Date().toLocaleTimeString()
        logDiv.textContent += `[${timestamp}] ${mensaje}\n`
        logDiv.scrollTop = logDiv.scrollHeight
      }

      function agregarDatos() {
        log('🔧 Iniciando agregado de datos de prueba...')

        try {
          const dataManager = new DataManager()

          const reportesPrueba = [
            {
              id: 'REP-000001',
              tipo: 'documentos-falsos',
              descripcion:
                'Se observó a una persona vendiendo documentos de identidad falsos cerca del parque central. Tiene una mesa con varios pasaportes y cédulas.',
              ubicacion: 'Parque Central, Santo Domingo Este',
              fecha_incidente: '2025-08-10T14:30:00.000Z',
              personas_involucradas:
                'Hombre de aproximadamente 40 años, altura media, con gorra azul',
              evidencia: 'Fotos tomadas desde lejos, testigos en el área',
              prioridad: 'alta',
              nombre_reportante: 'Juan Pérez',
              telefono_reportante: '809-555-0123',
              email_reportante: 'juan.perez@email.com',
              fecha_reporte: '2025-08-10T15:00:00.000Z',
              estado: 'pendiente',
              ip_reportante: '192.168.1.100',
              navegador: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            },
            {
              id: 'REP-000002',
              tipo: 'trabajo-irregular',
              descripcion:
                'Empresa constructora empleando trabajadores extranjeros sin permisos de trabajo. Condiciones laborales muy precarias.',
              ubicacion: 'Zona Industrial Las Américas, Santo Domingo',
              fecha_incidente: '2025-08-09T08:00:00.000Z',
              personas_involucradas:
                'Aproximadamente 15-20 trabajadores, supervisor con camioneta blanca',
              evidencia: 'Videos de los trabajadores llegando temprano en la mañana',
              prioridad: 'media',
              fecha_reporte: '2025-08-09T18:30:00.000Z',
              estado: 'en_revision',
              ip_reportante: '192.168.1.101',
              navegador: 'Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X)',
            },
            {
              id: 'REP-000003',
              tipo: 'trafico-personas',
              descripcion:
                'URGENTE: Se escucharon gritos de auxilio desde una casa abandonada. Varias personas encerradas.',
              ubicacion: 'Coordenadas: 18.4861, -69.9312',
              fecha_incidente: '2025-08-11T22:00:00.000Z',
              personas_involucradas:
                'Se escucharon voces de mujeres pidiendo ayuda, al menos 3-4 personas',
              evidencia: 'Grabación de audio de los gritos',
              prioridad: 'urgente',
              nombre_reportante: 'María González',
              telefono_reportante: '809-555-0456',
              fecha_reporte: '2025-08-11T22:15:00.000Z',
              estado: 'en_investigacion',
              ip_reportante: '192.168.1.102',
              navegador: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            },
            {
              id: 'REP-000004',
              tipo: 'establecimiento-irregular',
              descripcion:
                'Restaurant que no verifica estatus migratorio de empleados. Varios trabajadores sin documentación apropiada.',
              ubicacion: 'Av. Winston Churchill, Plaza comercial',
              fecha_incidente: '2025-08-08T19:00:00.000Z',
              personas_involucradas: 'Personal de cocina y meseros, gerente del local',
              prioridad: 'baja',
              fecha_reporte: '2025-08-08T20:00:00.000Z',
              estado: 'resuelto',
              ip_reportante: '192.168.1.103',
              navegador: 'Mozilla/5.0 (Android 11; Mobile)',
            },
          ]

          // Guardar cada reporte
          let exitosos = 0
          reportesPrueba.forEach((reporte) => {
            try {
              dataManager.guardarReporte(reporte)
              log(`✅ Reporte ${reporte.id} guardado exitosamente`)
              exitosos++
            } catch (error) {
              log(`❌ Error guardando reporte ${reporte.id}: ${error.message}`)
            }
          })

          log(`✅ ${exitosos}/${reportesPrueba.length} reportes agregados exitosamente`)
          log(`📊 Total de reportes en sistema: ${dataManager.obtenerReportes().length}`)
        } catch (error) {
          log(`❌ Error general: ${error.message}`)
        }
      }

      function verReportes() {
        try {
          const dataManager = new DataManager()
          const reportes = dataManager.obtenerReportes()

          log(`📊 REPORTES ACTUALES (${reportes.length} total):`)

          if (reportes.length === 0) {
            log('   No hay reportes guardados')
          } else {
            reportes.forEach((reporte, index) => {
              log(
                `   ${index + 1}. ${reporte.id} - ${reporte.tipo} - ${reporte.estado} - ${
                  reporte.prioridad
                }`
              )
            })
          }
        } catch (error) {
          log(`❌ Error obteniendo reportes: ${error.message}`)
        }
      }

      function limpiarDatos() {
        if (confirm('¿Estás seguro de que quieres limpiar todos los datos?')) {
          try {
            localStorage.removeItem('radarMigratorio_reportes')
            log('🗑️ Datos de reportes limpiados')
            verReportes()
          } catch (error) {
            log(`❌ Error limpiando datos: ${error.message}`)
          }
        }
      }

      function irAlAdmin() {
        window.location.href = 'admin/admin-login.html'
      }

      // Inicializar
      log('🚀 Sistema de pruebas cargado. DataManager inicializado.')
      verReportes()
    </script>
  </body>
</html>
